<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Online Kaartspel</title>
  <style>
    :root{--bg:#0a1220;--panel:#101d30;--p2:#0c1626;--txt:#e8eef6;--muted:#8a9bb4;--bd:rgba(255,255,255,.10);--gr:#6ae4a6;--re:#ff6b6b;--r:14px}
    *{box-sizing:border-box;margin:0;padding:0}
    body{font-family:system-ui,-apple-system,Segoe UI,Arial,sans-serif;background:var(--bg);color:var(--txt);min-height:100vh}
    .layout{display:grid;grid-template-columns:290px 1fr 230px;gap:12px;max-width:1200px;margin:0 auto;padding:12px}
    @media(max-width:900px){.layout{grid-template-columns:1fr}}
    .panel{background:var(--panel);border:1px solid var(--bd);border-radius:var(--r);padding:14px}
    h1{font-size:18px;margin-bottom:6px}
    h2{font-size:11px;color:var(--muted);margin-bottom:8px;text-transform:uppercase;letter-spacing:.06em}
    .div{height:1px;background:var(--bd);margin:10px 0}
    label{display:block;font-size:11px;color:var(--muted);margin-bottom:4px}
    input,select{width:100%;padding:8px 10px;border-radius:9px;border:1px solid var(--bd);background:var(--p2);color:var(--txt);font:inherit;outline:none}
    button{padding:8px 12px;border-radius:9px;border:1px solid var(--bd);background:rgba(255,255,255,.06);color:var(--txt);font:inherit;cursor:pointer;transition:background .1s}
    button:hover{background:rgba(255,255,255,.13)}button:active{transform:translateY(1px)}button:disabled{opacity:.35;cursor:not-allowed}
    button.gr{background:rgba(106,228,166,.18);border-color:rgba(106,228,166,.35)}
    button.re{background:rgba(255,107,107,.18);border-color:rgba(255,107,107,.35)}
    .row{display:flex;gap:7px;align-items:flex-end;flex-wrap:wrap}.row>*{flex:1;min-width:0}
    .pill{display:inline-flex;gap:5px;align-items:center;padding:6px 10px;border:1px solid var(--bd);border-radius:999px;background:rgba(255,255,255,.04);font-size:11px;color:var(--muted)}
    .tiny{font-size:11px;color:var(--muted)}

    /* Spelerlijst */
    #playersList{display:flex;flex-direction:column;gap:6px}
    .pRow{display:flex;justify-content:space-between;align-items:center;padding:8px 10px;border:1px solid var(--bd);border-radius:10px;background:rgba(255,255,255,.03);transition:border-color .2s,background .2s}
    .pRow.ghost-row{opacity:.5;font-style:italic}
    .pRow.my-turn{border-color:rgba(106,228,166,.4);background:rgba(106,228,166,.06)}
    .pLeft{display:flex;align-items:center;gap:8px;min-width:0}
    .avatar{width:30px;height:30px;border-radius:9px;display:grid;place-items:center;font-size:16px;border:1px solid rgba(255,255,255,.12);flex-shrink:0}
    .pName{white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:13px}
    .pStatus{font-size:11px;color:var(--muted);flex-shrink:0;text-align:right}

    /* Status bar */
    .sbar{display:flex;justify-content:space-between;align-items:center;gap:8px;flex-wrap:wrap;padding:8px 12px;border:1px solid var(--bd);border-radius:10px;background:rgba(255,255,255,.04)}

    /* Tafel */
    .table-wrap{border:1px solid var(--bd);border-radius:var(--r);background:radial-gradient(ellipse 600px 300px at 30% 40%,rgba(106,228,166,.07),transparent),rgba(255,255,255,.02);padding:14px;min-height:150px}
    #pileLabel{font-size:12px;color:var(--muted);margin-bottom:10px}
    #pileArea{display:flex;gap:10px;flex-wrap:wrap;min-height:88px;align-items:center}

    /* Kaarten */
    .playCard,.handCard{width:58px;height:82px;border-radius:11px;border:1px solid rgba(255,255,255,.15);background:rgba(12,22,38,.9);display:flex;flex-direction:column;align-items:center;justify-content:center;gap:2px;user-select:none}
    .playCard{box-shadow:0 6px 18px rgba(0,0,0,.35)}
    .handCard{cursor:pointer;transition:transform .08s,box-shadow .08s}
    .handCard:hover{background:rgba(20,35,58,.95);box-shadow:0 4px 12px rgba(0,0,0,.3)}
    .handCard.selected{transform:translateY(-7px);box-shadow:0 0 0 2px rgba(106,228,166,.6)}
    .cRank{font-weight:800;font-size:18px;line-height:1}
    .cSuit{font-size:12px;opacity:.75}
    .playCard.red,.handCard.red{color:#f87171}

    /* Knoppen onder tafel */
    .controls{display:flex;gap:7px;align-items:center;flex-wrap:wrap;margin-top:10px}
    .handWrap{border:1px solid var(--bd);border-radius:var(--r);padding:12px;background:rgba(255,255,255,.02)}
    #handArea{display:flex;gap:7px;flex-wrap:wrap;margin-top:8px;min-height:90px}

    /* ‚îÄ‚îÄ ACTIVITEITENLOG (rechter kolom) ‚îÄ‚îÄ */
    .actLog-panel{display:flex;flex-direction:column}
    #actLog{display:flex;flex-direction:column;gap:5px;overflow-y:auto;max-height:600px}
    .act-item{
      display:flex;align-items:flex-start;gap:7px;
      padding:8px 10px;border-radius:10px;
      border:1px solid var(--bd);background:rgba(255,255,255,.03);
      animation:slideIn .2s ease;transition:opacity .5s,transform .5s
    }
    .act-item.fading{opacity:0;transform:translateY(-4px)}
    .act-item.type-win{border-color:rgba(106,228,166,.35);background:rgba(106,228,166,.07)}
    .act-item.type-pass{opacity:.55}
    .act-avatar{width:28px;height:28px;border-radius:8px;display:grid;place-items:center;font-size:15px;flex-shrink:0;border:1px solid rgba(255,255,255,.1)}
    .act-body{flex:1;min-width:0}
    .act-name{font-size:12px;font-weight:600;color:var(--txt)}
    .act-desc{font-size:11px;color:var(--muted);margin-top:2px}
    .act-cards{display:flex;gap:4px;flex-wrap:wrap;margin-top:6px}
    .act-mini-card{
      width:34px;height:48px;border-radius:8px;
      border:1px solid rgba(255,255,255,.15);background:rgba(12,22,38,.9);
      display:flex;flex-direction:column;align-items:center;justify-content:center;gap:1px
    }
    .act-mini-card .cRank{font-size:13px;font-weight:800;line-height:1}
    .act-mini-card .cSuit{font-size:10px;opacity:.75}
    .act-mini-card.red{color:#f87171}
    @keyframes slideIn{from{opacity:0;transform:translateY(6px)}to{opacity:1;transform:none}}

    /* Eindscherm */
    #endPanel{display:none;border:1px solid var(--bd);border-radius:var(--r);padding:14px;background:rgba(255,255,255,.03)}
    #rankingEl{margin-top:8px;line-height:1.8;font-size:13px}
  </style>
</head>
<body>
<div class="layout">

  <!-- LINKS: lobby -->
  <div class="panel">
    <h1>Kaartspel üé¥</h1>
    <p class="tiny" style="margin-bottom:8px">Verliezer = laatste met kaarten.<br>Bij 2 spelers: ü§ñ wordt toegevoegd (past altijd).</p>
    <div class="div"></div>
    <label>Naam</label>
    <input id="nameInput" maxlength="18" placeholder="Bijv. Lloyd" style="margin-bottom:8px"/>
    <div class="row" style="margin-bottom:8px">
      <div><label>Emoji</label>
        <select id="emojiSelect">
          <option>ü¶ä</option><option>üêº</option><option>ü¶Å</option><option>üê∏</option>
          <option>ü¶â</option><option>üêô</option><option>ü¶Ñ</option><option>üê∫</option>
          <option>üêù</option><option>üß†</option><option>üéß</option><option>üöÄ</option>
        </select>
      </div>
      <div><label>Kleur</label>
        <select id="colorSelect">
          <option value="#6ae4a6">Mint</option><option value="#ffd166">Amber</option>
          <option value="#7aa7ff">Blauw</option><option value="#ff6b6b">Rood</option>
          <option value="#c77dff">Paars</option><option value="#f4a261">Oranje</option>
        </select>
      </div>
    </div>
    <div class="div"></div>
    <button id="createBtn" class="gr" style="width:100%;margin-bottom:8px">+ Nieuwe kamer</button>
    <div class="row" style="margin-bottom:8px">
      <div><label>Kamercode</label><input id="roomInput" maxlength="6" placeholder="AB12"/></div>
      <button id="joinBtn" style="flex:0 0 auto;align-self:flex-end">Join</button>
    </div>
    <div class="pill" id="roomPill" style="margin-bottom:8px">Nog niet in een kamer</div>
    <div class="row" style="margin-bottom:8px">
      <button id="startBtn" class="gr" disabled>Start spel</button>
      <button id="leaveBtn" class="re" disabled style="flex:0 0 auto">Verlaten</button>
    </div>
    <p class="tiny" id="lobbyHint" style="margin-bottom:10px">Maak of join een kamer.</p>
    <div class="div"></div>
    <h2>Spelers</h2>
    <div id="playersList"></div>
  </div>

  <!-- MIDDEN: tafel + hand -->
  <div style="display:flex;flex-direction:column;gap:10px">
    <div class="sbar">
      <div id="msgText" class="tiny">Klaar.</div>
      <div style="display:flex;gap:7px;flex-wrap:wrap">
        <span class="pill" id="youPill">‚Äî</span>
        <span class="pill" id="turnPill">Beurt: ‚Äî</span>
      </div>
    </div>
    <div class="table-wrap">
      <h2>Tafel</h2>
      <div id="pileLabel">Tafel leeg ‚Äî startspeler opent de ronde.</div>
      <div id="pileArea"></div>
    </div>
    <div class="controls">
      <button id="playBtn" class="gr" disabled>Speel geselecteerde kaarten</button>
      <button id="passBtn" disabled>Pas</button>
      <span class="tiny" id="selectionInfo">Selecteer kaarten (gelijke waarde).</span>
    </div>
    <div class="handWrap">
      <h2>Jouw hand</h2>
      <div id="handArea"></div>
    </div>
    <div id="endPanel">
      <h1 id="endTitle">Einde</h1>
      <p class="tiny" id="endDetails" style="margin-bottom:6px"></p>
      <div id="rankingEl"></div>
      <div class="row" style="margin-top:12px">
        <button id="rematchBtn" class="gr" disabled>Nieuwe pot</button>
        <button id="backLobbyBtn" class="re">Terug naar lobby</button>
      </div>
    </div>
  </div>

  <!-- RECHTS: activiteitenlog -->
  <div class="panel actLog-panel">
    <h2>Wat iedereen speelt</h2>
    <div id="actLog"></div>
    <p class="tiny" id="actEmpty" style="margin-top:8px;display:block">Nog niets gespeeld.</p>
  </div>

</div>
<script src="/socket.io/socket.io.js"></script>
<script src="/client.js"></script>
</body>
</html>
